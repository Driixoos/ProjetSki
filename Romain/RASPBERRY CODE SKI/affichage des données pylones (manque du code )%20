<?php
$host = "192.168.107.61";  // IP du Raspberry Pi
$dbname = "projksi";        // Nom de la base de données
$username = "nodered";      // Utilisateur MySQL
$password = "ciel";         // Mot de passe

// Connexion à la base de données
$conn = new mysqli($host, $username, $password, $dbname);
if ($conn->connect_error) {
    die("Connexion échouée: " . $conn->connect_error);
}

// Vérifier si l'ID de la remontée est passé en paramètre GET
if (isset($_GET['id_remontee'])) {
    $id_remontee = intval($_GET['id_remontee']);

    // Récupérer les pylônes associés à cette remontée
    $sql = "SELECT * FROM pylone WHERE id_remontee = $id_remontee";
    $result = $conn->query($sql);

    if ($result->num_rows > 0) {
        // Afficher les pylônes dans un tableau HTML
        echo "<table border='1'>
                <tr>
                    <th>ID Pylône</th>
                    <th>Latitude</th>
                    <th>Longitude</th>
                </tr>";
        
        // Affichage de chaque pylône
        while ($row = $result->fetch_assoc()) {
            echo "<tr>
                    <td>" . $row['id'] . "</td>
                    <td>" . $row['latitude'] . "</td>
                    <td>" . $row['longitude'] . "</td>
                </tr>";
        }

        echo "</table>";
    } else {
        echo "Aucun pylône trouvé pour cette remontée.";
    }
} else {
    echo "ID de remontée non spécifié.";
}

$conn->close();
?>
